{% extends 'blog/base.html' %}
{% block title %}{{ post.title }} - –ú–æ–π –±–ª–æ–≥{% endblock %}
{% block content %}

<!-- üì∑ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Å—Ç–∞ -->
{% if post.image %}
    <img src="{{ post.image.url }}" alt="{{ post.title }}" class="img-fluid mb-3" style="max-width: 600px;">
{% endif %}

<!-- üè∑Ô∏è –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ—Å—Ç–∞ -->
{% if post.category %}
  <p><strong>üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong>
     <a href="{% url 'category_posts' post.category.slug %}">
        {{ post.category.name }}
     </a>
  </p>
{% endif %}

<!-- üìù –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ—Å—Ç–∞ -->
<h1>{{ post.title }}</h1>
<p class="text-muted">üìÖ{{ post.date }}</p>
<p>{{ post.text }}</p>

<!-- üîñ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –ø–æ—Å—Ç–∞ -->
<p><strong>üîñ –¢–µ–≥–∏:</strong>
    {% for tag in post.tags.all %}
        <a href="{% url 'posts_by_tag' tag.slug %}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
    {% empty %}
        –Ω–µ—Ç —Ç–µ–≥–æ–≤
    {% endfor %}
</p>

<!-- üí¨ –ë–ª–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
<hr>
<h3>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ comments.count }})</h3>
{% if comments %}
  {% for comment in comments %}
    <div class="border p-2 mb-2 rounded bg-light">
      <p><strong>{{ comment.author.username }}</strong> ‚Äî {{ comment.created_at|date:"d.m.Y H:i" }}</p>
      <p>{{ comment.content }}</p>
    </div>
  {% endfor %}
{% else %}
  <p>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
{% endif %}

<!-- üì§ –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
<hr>
{% if user.is_authenticated %}
  <h4>üì§ –û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h4>
  <form method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn btn-success">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </form>
{% else %}
  <p><a href="{% url 'login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.</p>
{% endif %}

<!-- üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ –∏ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
<p><strong>üë§ –ê–≤—Ç–æ—Ä:</strong> {{ post.author.username }}</p>
{% if user == post.author %}
  <a class="btn btn-warning" href="{% url 'edit_post' post.id %}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
  <a class="btn btn-danger" href="{% url 'delete_post' post.id %}">–£–¥–∞–ª–∏—Ç—å</a>
  <a class="btn btn-secondary" href="{% url 'home' %}">–ù–∞–∑–∞–¥</a>
{% endif %}
{% endblock %}